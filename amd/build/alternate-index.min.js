define(["jquery","core/modal_factory","core/modal_events","core/str","block_quickmail/modal_create_alternate"],function(a,b,c,d,e){return{init:function(){a(document).click(function(b){a(b.target).hasClass("btn-delete-alt")&&(deleteAlternateId=a(b.target).attr("data-alternate-id"))});var f=a(".btn-delete-alt");b.create({type:b.types.CONFIRM,title:"Delete Alternate Email",body:"<p>This will permanently delete your alternate email, are you sure?</p>"},f).done(function(b){b.getRoot().on(c.yes,function(b){b.preventDefault(),a('input[name="delete_alternate_id"]').val(deleteAlternateId),a("#mform-manage-alternates").submit()})});var g=a(".btn-create-alt");d.get_string("alternate_new","block_quickmail").then(function(d){b.create({type:e.TYPE,title:d},g).done(function(b){b.getRoot().on(c.save,function(b){b.preventDefault();var c=!0;a("#inputEmail").removeClass("has-error"),a("#inputFirstname").removeClass("has-error"),a("#inputLastname").removeClass("has-error"),a("#inputAvailability").removeClass("has-error");var d=a("#inputEmail").val(),e=a("#inputFirstname").val(),f=a("#inputLastname").val(),g=a("#inputAvailability").val(),h=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;0!=d.length&&h.test(d)||(a("#inputEmail").addClass("has-error"),c=!1),0==e.length&&(a("#inputFirstname").addClass("has-error"),c=!1),0==f.length&&(a("#inputLastname").addClass("has-error"),c=!1),0==g.length&&(a("#inputAvailability").addClass("has-error"),c=!1),c&&(a('input[name="create_flag"]').val(1),a('input[name="firstname"]').val(e),a('input[name="lastname"]').val(f),a('input[name="email"]').val(d),a('input[name="availability"]').val(g),a("#mform-manage-alternates").submit())})})})}}});